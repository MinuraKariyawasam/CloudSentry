<!-- File: public/index.html -->

<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"
        integrity="sha384-/KNQL8Nu5gCHLqwqfQjA689Hhoqgi2S84SNUxC3roTe4EhJ9AfLkp8QiQcU8AMzI"
        crossorigin="anonymous"></script>
    <script>
        const socket = io();
        socket.on('log', data => {
            document.getElementById('logs').innerText += data;
        });
        socket.on('connect_error', (error) => {
            console.log('Socket.IO connection error:', error);
        });
    </script>
    <style>
        hr {
            border-width: 5px;
            font-weight: bold;
        }

        .jumbotron {
            background-color: #007bff;
            color: #fff;
            text-align: center;
        }

        .form-container {
            display: none;
        }

        #logs {
            background-color: black;
            padding: 70px;
            margin-bottom: 30px;
            color: white;
            width: 1100px;
            /* set a fixed width */
            height: 250px;
            /* set a fixed height */
            overflow: auto;
            /* add scrollbar when necessary */
        }
    </style>
    <title>CloudSentry - Cloud Monitoring Framework</title>

</head>

<body>
    <div class="jumbotron">
        <h1 class="display-4">CloudSentry</h1>
        <p class="lead">The modern minimalist cloud monitoring framework.</p>
        <a class="btn btn-outline-light btn-lg" href="/documentation">Documentation</a>
        <a class="btn btn-outline-light btn-lg" href="/logs">Centralized Logs</a>
        <a class="btn btn-outline-light btn-lg" href="/state">Deployment State</a>
    </div>
    <div class="container mt-5">
        <h3>Choose Server Operating System</h3>
        <form>
            <div class="form-group">
                <select class="form-control">
                    <option>Linux</option>
                    <option>Windows</option>
                </select>
            </div>
        </form>
        <hr>
        <h3 id="step3">Deploy Infrastructure Monitoring</h3>
        <div class="infra-monitoring">
            <div class="form-group">
                <div class="form-group">
                    <label for="exampleInputEmail1">Resource Group Name</label>
                    <input type="text" class="form-control" id="resource_group_name"
                        aria-describedby="resource_group_name">
                </div>
                <div class="form-group">
                    <label for="exampleInputPassword1">Location</label>
                    <input type="text" class="form-control" id="location">
                    <small id="location" class="form-text text-muted">
                        <a href="https://azure.microsoft.com/en-us/explore/global-infrastructure/geographies/#overview">
                            Discover more about Azure global infrastructure and how it all works.</a></small>
                </div>
                <div class="form-group">
                    <label for="exampleInputEmail1">subscriptionsId</label>
                    <input type="text" class="form-control" id="subscriptionsId" aria-describedby="subscriptionsId">
                </div>
                <div class="container mt-5">
                    <div class="row">
                        <div class="col-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="tickToForm1">
                                <label class="form-check-label" for="tickToForm1">
                                    Computer Monitor
                                </label>
                            </div>
                            <div class="form-container container-1 mt-3">
                                <form id="computer-monitor">
                                    <div class="form-group">
                                        <label for="value1">scaleset_name</label>
                                        <input type="text" class="form-control" id="scaleset_name" name="scaleset_name">
                                    </div>
                                    <div class="form-group">
                                        <label for="value1">cpu_operator</label>
                                        <input type="text" class="form-control" id="cpu_operator" name="cpu_operator">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">cpu_threshold</label>
                                        <input type="text" class="form-control" id="cpu_threshold" name="cpu_threshold">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">cpu_severity</label>
                                        <input type="text" class="form-control" id="cpu_severity" name="cpu_severity">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">cpu_frequency</label>
                                        <input type="text" class="form-control" id="cpu_frequency" name="cpu_frequency">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">cpu_window_size</label>
                                        <input type="text" class="form-control" id="cpu_window_size"
                                            name="cpu_window_size">
                                    </div>
                                    <hr>
                                    <div class="form-group">
                                        <label for="value1">memory_operator</label>
                                        <input type="text" class="form-control" id="memory_operator"
                                            name="memory_operator">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">memory_threshold</label>
                                        <input type="text" class="form-control" id="memory_threshold"
                                            name="memory_threshold">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">memory_severity</label>
                                        <input type="text" class="form-control" id="memory_severity"
                                            name="memory_severity">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">memory_frequency</label>
                                        <input type="text" class="form-control" id="memory_frequency"
                                            name="memory_frequency">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">memory_window_size</label>
                                        <input type="text" class="form-control" id="memory_window_size"
                                            name="cpu_window_size">
                                    </div>

                                </form>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="tickToForm2">
                                <label class="form-check-label" for="tickToForm2">
                                    Load Balancer Monitor
                                </label>
                            </div>
                            <div class="form-container container-2 mt-3">
                                <form id="computer-monitor">
                                    <div class="form-group">
                                        <label for="value1">appgateway_name</label>
                                        <input type="text" class="form-control" id="appgateway_name"
                                            name="appgateway_name">
                                    </div>
                                    <div class="form-group">
                                        <label for="value1">response_status_operator</label>
                                        <input type="text" class="form-control" id="response_status_operator"
                                            name="response_status_operator">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">response_status_threshold</label>
                                        <input type="text" class="form-control" id="response_status_threshold"
                                            name="response_status_threshold">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">response_status_severity</label>
                                        <input type="text" class="form-control" id="response_status_severity"
                                            name="response_status_severity">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">response_status_frequency</label>
                                        <input type="text" class="form-control" id="response_status_frequency"
                                            name="response_status_frequency">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">response_status_window_size</label>
                                        <input type="text" class="form-control" id="response_status_window_size"
                                            name="cpu_window_size">
                                    </div>
                                    <hr>
                                    <div class="form-group">
                                        <label for="value1">unhealthy_host_count_operator</label>
                                        <input type="text" class="form-control" id="unhealthy_host_count_operator"
                                            name="unhealthy_host_count_operator">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">unhealthy_host_count_threshold</label>
                                        <input type="text" class="form-control" id="unhealthy_host_count_threshold"
                                            name="unhealthy_host_count_threshold">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">unhealthy_host_count_severity</label>
                                        <input type="text" class="form-control" id="unhealthy_host_count_severity"
                                            name="unhealthy_host_count_severity">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">unhealthy_host_count_frequency</label>
                                        <input type="text" class="form-control" id="unhealthy_host_count_frequency"
                                            name="unhealthy_host_count_frequency">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">unhealthy_host_count_window_size</label>
                                        <input type="text" class="form-control" id="unhealthy_host_count_window_size"
                                            name="cpu_window_size">
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="" id="tickToForm3">
                                <label class="form-check-label" for="tickToForm3">
                                    Database Monitor
                                </label>
                            </div>
                            <div class="form-container container-3 mt-3">
                                <form>
                                    <div class="form-group">
                                        <label for="value1">database_name</label>
                                        <input type="text" class="form-control" id="database_name" name="database_name">
                                    </div>
                                    <div class="form-group">
                                        <label for="value1">server_name</label>
                                        <input type="text" class="form-control" id="server_name" name="server_name">
                                    </div>
                                    <div class="form-group">
                                        <label for="value1">database_cpu_operator</label>
                                        <input type="text" class="form-control" id="database_cpu_operator"
                                            name="database_cpu_operator">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">database_cpu_threshold</label>
                                        <input type="text" class="form-control" id="database_cpu_threshold"
                                            name="database_cpu_threshold">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">database_cpu_severity</label>
                                        <input type="text" class="form-control" id="database_cpu_severity"
                                            name="database_cpu_severity">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">database_cpu_frequency</label>
                                        <input type="text" class="form-control" id="database_cpu_frequency"
                                            name="database_cpu_frequency">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">database_cpu_window_size</label>
                                        <input type="text" class="form-control" id="database_cpu_window_size"
                                            name="cpu_window_size">
                                    </div>
                                    <hr>
                                    <div class="form-group">
                                        <label for="value1">database_storage_operator</label>
                                        <input type="text" class="form-control" id="database_storage_operator"
                                            name="database_storage_operator">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">database_storage_threshold</label>
                                        <input type="text" class="form-control" id="database_storage_threshold"
                                            name="database_storage_threshold">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">database_storage_severity</label>
                                        <input type="text" class="form-control" id="database_storage_severity"
                                            name="database_storage_severity">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">database_storage_frequency</label>
                                        <input type="text" class="form-control" id="database_storage_frequency"
                                            name="database_storage_frequency">
                                    </div>
                                    <div class="form-group">
                                        <label for="value2">database_storage_window_size</label>
                                        <input type="text" class="form-control" id="database_storage_window_size"
                                            name="cpu_window_size">
                                    </div>
                            </div>

                        </div>


                    </div>
                </div>
            </div>

        </div>

        <hr>

        <div class="application-monitoring">
            <h3 id="step3">Application Logs Monitoring Config</h3>
            <div class="form-group">
                <div class="form-group">
                    <label for="exampleInputEmail1">Mongodb Cluster URI</label>
                    <input type="text" class="form-control" id="dburi" aria-describedby="vmhost">
                </div>
            <div class="form-group">
                <label for="exampleInputEmail1">VM Host</label>
                <input type="text" class="form-control" id="vmhost" aria-describedby="vmhost">
            </div>
            <div class="form-group">
                <label for="exampleInputEmail1">Bastion Host</label>
                <input type="text" class="form-control" id="bastionhost" aria-describedby="bastionhost">
            </div>
            <div class="form-group">
                <label for="exampleInputEmail1">VM Username</label>
                <input type="text" class="form-control" id="vmusername" aria-describedby="vmusername">
            </div>
            <div class="form-group">
                <label for="exampleInputEmail1">VM Password</label>
                <input type="password" class="form-control" id="vmpassword" aria-describedby="vmpassword">
            </div>
            <div class="form-group">
                <label for="exampleInputEmail1">Bastion Username</label>
                <input type="text" class="form-control" id="bastionusername" aria-describedby="bastionusername">
            </div>
            <div class="form-group">
                <label for="exampleInputEmail1">Bastion Password</label>
                <input type="password" class="form-control" id="bastionpassword" aria-describedby="bastionpassword">
            </div>
            <div class="form-group">
                <label for="exampleInputEmail1">Application Log File Path</label>
                <input type="text" class="form-control" id="logFilePath" aria-describedby="logFilePath">
            </div>
        </div>
        <hr>
        <div class="action-group">
            <h3 id="step3">Configure Alert Receiver</h3>
            <div class="form-group">
                <label for="ReceiverName">Receiver Name</label>
                <input type="text" class="form-control" id="receiverName" aria-describedby="logFilePath">
            </div>
            <div class="form-group">
                <label for="ReceiverEmail">Receiver Email</label>
                <input type="text" class="form-control" id="receiverEmail" aria-describedby="logFilePath">
            </div>
        </div>
        <br>

        <button type="button" class="btn btn-primary" id="btn-submit">Deploy Monitoring</button>
        <button type="button" class="btn btn-primary" id="btn-submit-with-latest-state">Restart</button>
        <button type="button" class="btn btn-danger" id="btn-submit-restart">Destroy Monitoring</button>
        <hr>
        <h3 id="step3">Monitor Live Logs</h3>
        <p>
            CloudSentry provides the ability to monitor live logs in real-time, giving you valuable insights into the performance and behavior of your deployment. Additionally, our advanced log analytics capabilities provide you with a centralized view of your entire cloud deployment, making it easier to spot trends and identify potential problems.
        </p>
        <div id="logs" class="mt-5">
            <!-- Logs will be displayed here -->
        </div>
    </div>
    <script>
        const checkbox1 = document.querySelector("#tickToForm1");
        const formContainer1 = document.querySelector(".container-1");

        checkbox1.addEventListener("change", function (event) {
            if (event.target.checked) {
                formContainer1.style.display = "block";
            } else {
                formContainer1.style.display = "none";
            }
        });
        const checkbox2 = document.querySelector("#tickToForm2");
        const formContainer2 = document.querySelector(".container-2");

        checkbox2.addEventListener("change", function (event) {
            if (event.target.checked) {
                formContainer2.style.display = "block";
            } else {
                formContainer2.style.display = "none";
            }
        });
        const checkbox3 = document.querySelector("#tickToForm3");
        const formContainer3 = document.querySelector(".container-3");

        checkbox3.addEventListener("change", function (event) {
            if (event.target.checked) {
                formContainer3.style.display = "block";
            } else {
                formContainer3.style.display = "none";
            }
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script>
        const logContainer = document.querySelector('#log-container');
        $('#btn-submit').click(function (e) {
            e.preventDefault();
            $.ajax({
                type: 'POST',
                url: '/infra-monitor',
                data: {
                    resource_group_name: $('#resource_group_name').val(),
                    location: $('#location').val(),
                    subscriptionsId: $('#subscriptionsId').val(),
                    log_file_path: $('#logFilePath').val(),
                    mongo_db_uri: $('#dburi').val(),
                    action_group_receiver_name: $('#receiverName').val(),
                    action_group_receiver_email: $('#receiverEmail').val(),
                    // security details
                    vm_host: $('#vmhost').val(),
                    vm_user: $('#vmusername').val(),
                    vm_password: $('#vmpassword').val(),
                    bastion_host: $('#bastionhost').val(),
                    bastion_user: $('#bastionusername').val(),
                    bastion_password: $('#bastionpassword').val(),
                    // scaleset variables
                    scaleset_name: $('#scaleset_name').val(),
                    // ----------------------------------
                    cpu_operator: $('#cpu_operator').val(),
                    cpu_threshold: $('#cpu_threshold').val(),
                    cpu_severity: $('#cpu_severity').val(),
                    cpu_frequency: $('#cpu_frequency').val(),
                    cpu_window_size: $('#cpu_window_size').val(),
                    // ----------------------------------
                    memory_operator: $('#memory_operator').val(),
                    memory_threshold: $('#memory_threshold').val(),
                    memory_severity: $('#memory_severity').val(),
                    memory_frequency: $('#memory_frequency').val(),
                    memory_window_size: $('#memory_window_size').val(),
                    // application gateway variables
                    appgateway_name: $('#appgateway_name').val(),
                    // ----------------------------------
                    response_status_operator: $('#response_status_operator').val(),
                    response_status_threshold: $('#response_status_threshold').val(),
                    response_status_severity: $('#response_status_severity').val(),
                    response_status_frequency: $('#response_status_frequency').val(),
                    response_status_window_size: $('#response_status_window_size').val(),
                    // ----------------------------------
                    unhealthy_host_count_operator: $('#unhealthy_host_count_operator').val(),
                    unhealthy_host_count_threshold: $('#unhealthy_host_count_threshold').val(),
                    unhealthy_host_count_severity: $('#unhealthy_host_count_severity').val(),
                    unhealthy_host_count_frequency: $('#unhealthy_host_count_frequency').val(),
                    unhealthy_host_count_window_size: $('#unhealthy_host_count_window_size').val(),
                    // application gateway variables
                    database_name: $('#database_name').val(),
                    server_name: $('#server_name').val(),
                    // ----------------------------------
                    database_cpu_operator: $('#database_cpu_operator').val(),
                    database_cpu_threshold: $('#database_cpu_threshold').val(),
                    database_cpu_severity: $('#database_cpu_severity').val(),
                    database_cpu_frequency: $('#database_cpu_frequency').val(),
                    database_cpu_window_size: $('#database_cpu_window_size').val(),
                    // ----------------------------------
                    database_storage_operator: $('#database_storage_operator').val(),
                    database_storage_threshold: $('#database_storage_threshold').val(),
                    database_storage_severity: $('#database_storage_severity').val(),
                    database_storage_frequency: $('#database_storage_frequency').val(),
                    database_storage_window_size: $('#database_storage_window_size').val(),
                },
                success: function (data) { }
            });
        });
        $('#btn-submit-with-latest-state').click(function (e) {
            e.preventDefault();
            $.ajax({
                type: 'POST',
                url: '/restart-server',
                data: {},
                success: function (data) { }
            });
        });
        $('#btn-submit-restart').click(function (e) {
            e.preventDefault();
            $.ajax({
                type: 'POST',
                url: '/destroy',
                data: {},
                success: function (data) { }
            });
        });
    </script>
</body>

</html>